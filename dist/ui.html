<h3>Change Banner By Multiple Language</h3><input type="file" title="選擇檔案" id="file_input"> <button id="submit">Start</button><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script><script>const wsName = "工作表1"

  const fileInput = document.getElementById("file_input")
  let fileReader = new FileReader()
  fileInput.addEventListener('change', (event) => {
    const files = event.target.files;
    const file = files[0]

    fileReader.readAsBinaryString(file)
  })

  let rowData = [];
  fileReader.addEventListener("load", function(event) {
    let data = event.target.result; //array buffer
    let wb = XLSX.read(data, {type: "binary"});
    
    wb.SheetNames.forEach(function(sheetName){
      if (sheetName === wsName) {
        let rowObject = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);
        rowData = rowObject;
      } 
    })
  })

  document.getElementById('submit').onclick = () => {
    parent.postMessage({ pluginMessage: rowData }, '*')
  }</script>