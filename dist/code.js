(()=>{"use strict";function e(e,n,t){return t.find((function(t){return t.name===n&&t.region===e})).text}var n=function(e,n,t,a){return new(t||(t=Promise))((function(i,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function f(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,f)}s((a=a.apply(e,n||[])).next())}))};figma.showUI(__html__,{width:480,height:240}),figma.ui.onmessage=a=>n(void 0,void 0,void 0,(function*(){if("close"!==a)if("export"===a)!function(){n(this,void 0,void 0,(function*(){let e=[];for(let n of figma.currentPage.selection)t=n.name,yield n.exportAsync(undefined).then((n=>{e.push({name:t,buffer:n})})).catch((e=>{console.log("Error: ",e)}));figma.ui.postMessage(e)}))}();else{let t;const i=e=>n(void 0,void 0,void 0,(function*(){yield figma.listAvailableFontsAsync().then((n=>{let a=n.find((function(n){return n.fontName.family==e}));t=a.fontName}))}));let o=function(e){let n=[];for(let t of e){const e=JSON.stringify(t),a=JSON.parse(e);switch(a.Name){case"主標":case"小標":n.unshift({name:a.Name,region:a.Region,text:a.Text,fontFamily:a.FontFamily,fontStyle:a.FontStyle})}}return n}(a);for(let e of o)null!=e.fontFamily&&(yield figma.loadFontAsync({family:e.fontFamily,style:e.fontStyle}));for(const n of figma.currentPage.selection)switch(n.name){case"主標":let a=figma.getNodeById(n.id);for(let c of a.children)switch(c.name){case"cn":yield i("Yu Gothic");let a=e(c.name,n.name,o);c.characters=a,c.fontName=t;break;case"th":case"mm":case"vn":case"id":c.characters=e(c.name,n.name,o);break;case"en":c.characters=e(c.name,n.name,o),yield i("Yrsa"),c.fontName=t}break;case"小標":let c=figma.getNodeById(n.id);for(let t of c.children)switch(t.name){case"cn":case"th":case"mm":case"vn":case"id":case"en":t.characters=e(t.name,n.name,o)}}figma.closePlugin()}else figma.closePlugin()}));let t=""})();