(()=>{"use strict";var e=function(e,n,t,i){return new(t||(t=Promise))((function(a,o){function c(e){try{s(i.next(e))}catch(e){o(e)}}function f(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,f)}s((i=i.apply(e,n||[])).next())}))};figma.showUI(__html__,{width:480,height:240});let n=[];function t(e,n,t){e.visible=!1;let i=(a=e.name,o=n,t.find((function(e){return e.name===o&&e.region===a})));var a,o;return e.characters=i.text,e.fontName={family:i.fontFamily,style:i.fontStyle},e}figma.ui.onmessage=a=>e(void 0,void 0,void 0,(function*(){if("export"===a)!function(){e(this,void 0,void 0,(function*(){let t=[];const a=n=>e(this,void 0,void 0,(function*(){for(let e of figma.currentPage.children)if("預覽"===e.name){let a=figma.getNodeById(e.id);for(let e of a.children)i=e.name,yield e.exportAsync(undefined).then((e=>{t.push({lang:n,name:i,buffer:e})}))}}));for(let e=0;e<n.length/2;e++)switch(n[e].name){case"cn":let e=n.filter((e=>"cn"===e.name));e.forEach((e=>{e.visible=!0})),a("cn").then((()=>console.log("insert cn"))),e.forEach((e=>{e.visible=!1}))}console.log(t),figma.ui.postMessage(t)}))}();else{let e=function(e){let n=[];for(let t of e){const e=JSON.stringify(t),i=JSON.parse(e);switch(i.Name){case"主標":case"小標":n.unshift({name:i.Name,region:i.Region,text:i.Text,fontFamily:i.FontFamily,fontStyle:i.FontStyle})}}return n}(a);for(let n of e)null!=n.fontFamily&&(yield figma.loadFontAsync({family:n.fontFamily,style:n.fontStyle}));for(const i of figma.currentPage.selection)switch(i.name){case"主標":figma.getNodeById(i.id).children.forEach((a=>{switch(a.name){case"cn":case"en":case"th":case"mm":case"vn":case"id":n.unshift(t(a,i.name,e))}}));break;case"小標":figma.getNodeById(i.id).children.forEach((a=>{switch(a.name){case"cn":case"en":case"th":case"mm":case"vn":case"id":n.unshift(t(a,i.name,e))}}))}}}));let i=""})();