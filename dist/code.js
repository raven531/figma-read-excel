(()=>{"use strict";var e=function(e,n,t,i){return new(t||(t=Promise))((function(a,o){function c(e){try{s(i.next(e))}catch(e){o(e)}}function f(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,f)}s((i=i.apply(e,n||[])).next())}))};function n(e,n,t){e.visible=!1;let i=(a=e.name,o=n,t.find((function(e){return e.name===o&&e.region===a})));var a,o;return e.characters=i.text,e.fontName={family:i.fontFamily,style:i.fontStyle},e}figma.showUI(__html__,{width:480,height:240}),figma.ui.onmessage=i=>e(void 0,void 0,void 0,(function*(){if("export"===i)!function(){e(this,void 0,void 0,(function*(){let e=[];for(let n of figma.currentPage.selection)t=n.name,yield n.exportAsync(undefined).then((n=>{e.push({name:t,buffer:n})})).catch((e=>{console.log("Error: ",e)}));figma.ui.postMessage(e)}))}();else{let e=function(e){let n=[];for(let t of e){const e=JSON.stringify(t),i=JSON.parse(e);switch(i.Name){case"主標":case"小標":n.unshift({name:i.Name,region:i.Region,text:i.Text,fontFamily:i.FontFamily,fontStyle:i.FontStyle})}}return n}(i);for(let n of e)null!=n.fontFamily&&(yield figma.loadFontAsync({family:n.fontFamily,style:n.fontStyle}));let t=[];for(const i of figma.currentPage.selection)switch(i.name){case"主標":figma.getNodeById(i.id).children.forEach((a=>{switch(a.name){case"cn":case"en":case"th":case"mm":case"vn":case"id":t.unshift(n(a,i.name,e))}}));break;case"小標":figma.getNodeById(i.id).children.forEach((a=>{switch(a.name){case"cn":case"en":case"th":case"mm":case"vn":case"id":t.unshift(n(a,i.name,e))}}))}figma.closePlugin()}}));let t=""})();